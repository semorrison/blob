%!TEX root = ../blob1.tex

\section{The blob complex}
\label{sec:blob-definition}

Let $X$ be an $n$-manifold.
Let $\cC$ be a fixed system of fields (enriched over Vect) and local relations.
(If $\cC$ is not enriched over Vect, we can make it so by allowing finite
linear combinations of elements of $\cC(X; c)$, for fixed $c\in \cC(\bd X)$.)

In this section we will usually suppress boundary conditions on $X$ from the notation
(e.g. write $\lf(X)$ instead of $\lf(X; c)$).

We want to replace the quotient
\[
	A(X) \deq \lf(X) / U(X)
\]
of the previous section with a resolution
\[
	\cdots \to \bc_2(X) \to \bc_1(X) \to \bc_0(X) .
\]

We will define $\bc_0(X)$, $\bc_1(X)$ and $\bc_2(X)$, then give the general case $\bc_k(X)$.

We of course define $\bc_0(X) = \lf(X)$.
(If $X$ has nonempty boundary, instead define $\bc_0(X; c) = \lf(X; c)$.
We'll omit this sort of detail in the rest of this section.)
In other words, $\bc_0(X)$ is just the vector space of all (linearized) fields on $X$.

$\bc_1(X)$ is, roughly, the space of all local relations that can be imposed on $\bc_0(X)$.
Less roughly (but still not the official definition), $\bc_1(X)$ is finite linear
combinations of 1-blob diagrams, where a 1-blob diagram consists of
\begin{itemize}
\item An embedded closed ball (``blob") $B \sub X$.
\item A field $r \in \cC(X \setmin B; c)$
(for some $c \in \cC(\bd B) = \cC(\bd(X \setmin B))$).
\item A local relation field $u \in U(B; c)$
(same $c$ as previous bullet).
\end{itemize}
(See Figure \ref{blob1diagram}.)
\begin{figure}[t]\begin{equation*}
\mathfig{.6}{definition/single-blob}
\end{equation*}\caption{A 1-blob diagram.}\label{blob1diagram}\end{figure}
In order to get the linear structure correct, we (officially) define
\[
	\bc_1(X) \deq \bigoplus_B \bigoplus_c U(B; c) \otimes \lf(X \setmin B; c) .
\]
The first direct sum is indexed by all blobs $B\subset X$, and the second
by all boundary conditions $c \in \cC(\bd B)$.
Note that $\bc_1(X)$ is spanned by 1-blob diagrams $(B, u, r)$.

Define the boundary map $\bd : \bc_1(X) \to \bc_0(X)$ by 
\[ 
	(B, u, r) \mapsto u\bullet r, 
\]
where $u\bullet r$ denotes the field on $X$ obtained by gluing $u$ to $r$.
In other words $\bd : \bc_1(X) \to \bc_0(X)$ is given by
just erasing the blob from the picture
(but keeping the blob label $u$).

Note that the skein space $A(X)$
is naturally isomorphic to $\bc_0(X)/\bd(\bc_1(X))) = H_0(\bc_*(X))$. This is Property \ref{property:skein-modules}, and also used in the second half of Property \ref{property:contractibility}.

$\bc_2(X)$ is, roughly, the space of all relations (redundancies, syzygies) among the 
local relations encoded in $\bc_1(X)$.
More specifically, $\bc_2(X)$ is the space of all finite linear combinations of
2-blob diagrams, of which there are two types, disjoint and nested.

A disjoint 2-blob diagram consists of
\begin{itemize}
\item A pair of closed balls (blobs) $B_0, B_1 \sub X$ with disjoint interiors.
\item A field $r \in \cC(X \setmin (B_0 \cup B_1); c_0, c_1)$
(where $c_i \in \cC(\bd B_i)$).
\item Local relation fields $u_i \in U(B_i; c_i)$, $i=1,2$. \nn{We're inconsistent with the indexes -- are they 0,1 or 1,2? I'd prefer 1,2.}
\end{itemize}
(See Figure \ref{blob2ddiagram}.)
\begin{figure}[t]\begin{equation*}
\mathfig{.6}{definition/disjoint-blobs}
\end{equation*}\caption{A disjoint 2-blob diagram.}\label{blob2ddiagram}\end{figure}
We also identify $(B_0, B_1, u_0, u_1, r)$ with $-(B_1, B_0, u_1, u_0, r)$;
reversing the order of the blobs changes the sign.
Define $\bd(B_0, B_1, u_0, u_1, r) = 
(B_1, u_1, u_0\bullet r) - (B_0, u_0, u_1\bullet r) \in \bc_1(X)$.
In other words, the boundary of a disjoint 2-blob diagram
is the sum (with alternating signs)
of the two ways of erasing one of the blobs.
It's easy to check that $\bd^2 = 0$.

A nested 2-blob diagram consists of
\begin{itemize}
\item A pair of nested balls (blobs) $B_0 \sub B_1 \sub X$.
\item A field $r \in \cC(X \setmin B_0; c_0)$
(for some $c_0 \in \cC(\bd B_0)$), which is splittable along $\bd B_1$.
\item A local relation field $u_0 \in U(B_0; c_0)$.
\end{itemize}
(See Figure \ref{blob2ndiagram}.)
\begin{figure}[t]\begin{equation*}
\mathfig{.6}{definition/nested-blobs}
\end{equation*}\caption{A nested 2-blob diagram.}\label{blob2ndiagram}\end{figure}
Let $r = r_1 \bullet r'$, where $r_1 \in \cC(B_1 \setmin B_0; c_0, c_1)$
(for some $c_1 \in \cC(B_1)$) and
$r' \in \cC(X \setmin B_1; c_1)$.
Define $\bd(B_0, B_1, u_0, r) = (B_1, u_0\bullet r_1, r') - (B_0, u_0, r)$.
Note that the requirement that
local relations are an ideal with respect to gluing guarantees that $u_0\bullet r_1 \in U(B_1)$.
As in the disjoint 2-blob case, the boundary of a nested 2-blob is the alternating
sum of the two ways of erasing one of the blobs.
If we erase the inner blob, the outer blob inherits the label $u_0\bullet r_1$.
It is again easy to check that $\bd^2 = 0$.

As with the 1-blob diagrams, in order to get the linear structure correct it is better to define
(officially)
\begin{eqnarray*}
	\bc_2(X) & \deq &
	\left( 
		\bigoplus_{B_0, B_1 \text{disjoint}} \bigoplus_{c_0, c_1}
			U(B_0; c_0) \otimes U(B_1; c_1) \otimes \lf(X\setmin (B_0\cup B_1); c_0, c_1)
	\right) \\
	&& \bigoplus \left( 
		\bigoplus_{B_0 \subset B_1} \bigoplus_{c_0}
			U(B_0; c_0) \otimes \lf(X\setmin B_0; c_0)
	\right) .
\end{eqnarray*}
The final $\lf(X\setmin B_0; c_0)$ above really means fields splittable along $\bd B_1$,
but we didn't feel like introducing a notation for that.
For the disjoint blobs, reversing the ordering of $B_0$ and $B_1$ introduces a minus sign
(rather than a new, linearly independent 2-blob diagram).

Now for the general case.
A $k$-blob diagram consists of
\begin{itemize}
\item A collection of blobs $B_i \sub X$, $i = 0, \ldots, k-1$.
For each $i$ and $j$, we require that either $B_i$ and $B_j$ have disjoint interiors or
$B_i \sub B_j$ or $B_j \sub B_i$.
(The case $B_i = B_j$ is allowed.
If $B_i \sub B_j$ the boundaries of $B_i$ and $B_j$ are allowed to intersect.)
If a blob has no other blobs strictly contained in it, we call it a twig blob.
\nn{need to allow the case where $B\to X$ is not an embedding
on $\bd B$.  this is because any blob diagram on $X_{cut}$ should give rise to one on $X_{gl}$
and blobs are allowed to meet $\bd X$.}
\item Fields (boundary conditions) $c_i \in \cC(\bd B_i)$.
(These are implied by the data in the next bullets, so we usually
suppress them from the notation.)
$c_i$ and $c_j$ must have identical restrictions to $\bd B_i \cap \bd B_j$
if the latter space is not empty.
\item A field $r \in \cC(X \setmin B^t; c^t)$,
where $B^t$ is the union of all the twig blobs and $c^t \in \cC(\bd B^t)$
is determined by the $c_i$'s.
$r$ is required to be splittable along the boundaries of all blobs, twigs or not.
\item For each twig blob $B_j$ a local relation field $u_j \in U(B_j; c_j)$,
where $c_j$ is the restriction of $c^t$ to $\bd B_j$.
If $B_i = B_j$ then $u_i = u_j$.
\end{itemize}
(See Figure \ref{blobkdiagram}.)
\begin{figure}[t]\begin{equation*}
\mathfig{.7}{definition/k-blobs}
\end{equation*}\caption{A $k$-blob diagram.}\label{blobkdiagram}\end{figure}

If two blob diagrams $D_1$ and $D_2$ 
differ only by a reordering of the blobs, then we identify
$D_1 = \pm D_2$, where the sign is the sign of the permutation relating $D_1$ and $D_2$.

$\bc_k(X)$ is, roughly, all finite linear combinations of $k$-blob diagrams.
As before, the official definition is in terms of direct sums
of tensor products:
\[
	\bc_k(X) \deq \bigoplus_{\overline{B}} \bigoplus_{\overline{c}}
		\left( \otimes_j U(B_j; c_j)\right) \otimes \lf(X \setmin B^t; c^t) .
\]
Here $\overline{B}$ runs over all configurations of blobs, satisfying the conditions above.
$\overline{c}$ runs over all boundary conditions, again as described above.
$j$ runs over all indices of twig blobs. The final $\lf(X \setmin B^t; c^t)$ must be interpreted as fields which are splittable along all of the blobs in $\overline{B}$.

The boundary map 
\[
	\bd : \bc_k(X) \to \bc_{k-1}(X)
\]
is defined as follows.
Let $b = (\{B_i\}, \{u_j\}, r)$ be a $k$-blob diagram.
Let $E_j(b)$ denote the result of erasing the $j$-th blob.
If $B_j$ is not a twig blob, this involves only decrementing
the indices of blobs $B_{j+1},\ldots,B_{k-1}$.
If $B_j$ is a twig blob, we have to assign new local relation labels
if removing $B_j$ creates new twig blobs.
If $B_l$ becomes a twig after removing $B_j$, then set $u_l = u_j\bullet r_l$,
where $r_l$ is the restriction of $r$ to $B_l \setmin B_j$.
Finally, define
\eq{
    \bd(b) = \sum_{j=0}^{k-1} (-1)^j E_j(b).
}
The $(-1)^j$ factors imply that the terms of $\bd^2(b)$ all cancel.
Thus we have a chain complex.

We define the {\it support} of a blob diagram $b$, $\supp(b) \sub X$, 
to be the union of the blobs of $b$.
For $y \in \bc_*(X)$ with $y = \sum c_i b_i$ ($c_i$ a non-zero number, $b_i$ a blob diagram),
we define $\supp(y) \deq \bigcup_i \supp(b_i)$.

We note that blob diagrams in $X$ have a structure similar to that of a simplicial set,
but with simplices replaced by a more general class of combinatorial shapes.
Let $P$ be the minimal set of (isomorphisms classes of) polyhedra which is closed under products
and cones, and which contains the point.
We can associate an element $p(b)$ of $P$ to each blob diagram $b$ 
(equivalently, to each rooted tree) according to the following rules:
\begin{itemize}
\item $p(\emptyset) = pt$, where $\emptyset$ denotes a 0-blob diagram or empty tree;
\item $p(a \du b) = p(a) \times p(b)$, where $a \du b$ denotes the distant (non-overlapping) union of two blob diagrams (equivalently, join two trees at the roots); and
\item $p(\bar{b}) = \kone(p(b))$, where $\bar{b}$ is obtained from $b$ by adding an outer blob which encloses all the others.
\end{itemize}
For example, a diagram of $k$ strictly nested blobs corresponds to a $k$-simplex, while
a diagram of $k$ disjoint blobs corresponds to a $k$-cube.
(This correspondence works best if we thing of each twig label $u_i$ as having the form
$x - s(e(x))$, where $x$ is an arbitrary field on $B_i$, $e: \cC(B_i) \to C$ is the evaluation map, 
and $s:C \to \cC(B_i)$ is some fixed section of $e$.)


