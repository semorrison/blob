%!TEX root = ../blob1.tex

\section{TQFTs via fields}
%\label{sec:definitions}

In this section we review the construction of TQFTs from ``topological fields".
For more details see xxxx.

We only consider compact manifolds, so if $Y \sub X$ is a closed codimension 0
submanifold of $X$, then $X \setmin Y$ implicitly means the closure
$\overline{X \setmin Y}$.


\subsection{Systems of fields}
\label{sec:fields}

Let $\cM_k$ denote the category with objects 
unoriented PL manifolds of dimension
$k$ and morphisms homeomorphisms.
(We could equally well work with a different category of manifolds ---
oriented, topological, smooth, spin, etc. --- but for definiteness we
will stick with unoriented PL.)

%Fix a top dimension $n$, and a symmetric monoidal category $\cS$ whose objects are sets. While reading the definition, you should just think about the case $\cS = \Set$ with cartesian product, until you reach the discussion of a \emph{linear system of fields} later in this section, where $\cS = \Vect$, and \S \ref{sec:homological-fields}, where $\cS = \Kom$.

A $n$-dimensional {\it system of fields} in $\cS$
is a collection of functors $\cC_k : \cM_k \to \Set$ for $0 \leq k \leq n$
together with some additional data and satisfying some additional conditions, all specified below.

\nn{refer somewhere to my TQFT notes \cite{kw:tqft}}

Before finishing the definition of fields, we give two motivating examples
(actually, families of examples) of systems of fields.

The first examples: Fix a target space $B$, and let $\cC(X)$ be the set of continuous maps
from X to $B$.

The second examples: Fix an $n$-category $C$, and let $\cC(X)$ be 
the set of sub-cell-complexes of $X$ with codimension-$j$ cells labeled by
$j$-morphisms of $C$.
One can think of such sub-cell-complexes as dual to pasting diagrams for $C$.
This is described in more detail below.

Now for the rest of the definition of system of fields.
\begin{enumerate}
\item There are boundary restriction maps $\cC_k(X) \to \cC_{k-1}(\bd X)$, 
and these maps are a natural
transformation between the functors $\cC_k$ and $\cC_{k-1}\circ\bd$.
For $c \in \cC_{k-1}(\bd X)$, we will denote by $\cC_k(X; c)$ the subset of 
$\cC(X)$ which restricts to $c$.
In this context, we will call $c$ a boundary condition.
\item The subset $\cC_n(X;c)$ of top fields with a given boundary condition is an object in our symmetric monoidal category $\cS$. (This condition is of course trivial when $\cS = \Set$.) If the objects are sets with extra structure (e.g. $\cS = \Vect$ or $\Kom$), then this extra structure is considered part of the definition of $\cC_n$. Any maps mentioned below between top level fields must be morphisms in $\cS$.
\item $\cC_k$ is compatible with the symmetric monoidal
structures on $\cM_k$, $\Set$ and $\cS$: $\cC_k(X \du W) \cong \cC_k(X)\times \cC_k(W)$,
compatibly with homeomorphisms, restriction to boundary, and orientation reversal.
We will call the projections $\cC(X_1 \du X_2) \to \cC(X_i)$
restriction maps.
\item Gluing without corners.
Let $\bd X = Y \du -Y \du W$, where $Y$ and $W$ are closed $k{-}1$-manifolds.
Let $X\sgl$ denote $X$ glued to itself along $\pm Y$.
Using the boundary restriction, disjoint union, and (in one case) orientation reversal
maps, we get two maps $\cC_k(X) \to \cC(Y)$, corresponding to the two
copies of $Y$ in $\bd X$.
Let $\Eq_Y(\cC_k(X))$ denote the equalizer of these two maps.
Then (here's the axiom/definition part) there is an injective ``gluing" map
\[
	\Eq_Y(\cC_k(X)) \hookrightarrow \cC_k(X\sgl) ,
\]
and this gluing map is compatible with all of the above structure (actions
of homeomorphisms, boundary restrictions, orientation reversal, disjoint union).
Furthermore, up to homeomorphisms of $X\sgl$ isotopic to the identity,
the gluing map is surjective.
From the point of view of $X\sgl$ and the image $Y \subset X\sgl$ of the 
gluing surface, we say that fields in the image of the gluing map
are transverse to $Y$ or splittable along $Y$.
\item Gluing with corners.
Let $\bd X = Y \cup -Y \cup W$, where $\pm Y$ and $W$ might intersect along their boundaries.
Let $X\sgl$ denote $X$ glued to itself along $\pm Y$.
Note that $\bd X\sgl = W\sgl$, where $W\sgl$ denotes $W$ glued to itself
(without corners) along two copies of $\bd Y$.
Let $c\sgl \in \cC_{k-1}(W\sgl)$ be a be a splittable field on $W\sgl$ and let
$c \in \cC_{k-1}(W)$ be the cut open version of $c\sgl$.
Let $\cC^c_k(X)$ denote the subset of $\cC(X)$ which restricts to $c$ on $W$.
(This restriction map uses the gluing without corners map above.)
Using the boundary restriction, gluing without corners, and (in one case) orientation reversal
maps, we get two maps $\cC^c_k(X) \to \cC(Y)$, corresponding to the two
copies of $Y$ in $\bd X$.
Let $\Eq^c_Y(\cC_k(X))$ denote the equalizer of these two maps.
Then (here's the axiom/definition part) there is an injective ``gluing" map
\[
	\Eq^c_Y(\cC_k(X)) \hookrightarrow \cC_k(X\sgl, c\sgl) ,
\]
and this gluing map is compatible with all of the above structure (actions
of homeomorphisms, boundary restrictions, orientation reversal, disjoint union).
Furthermore, up to homeomorphisms of $X\sgl$ isotopic to the identity,
the gluing map is surjective.
From the point of view of $X\sgl$ and the image $Y \subset X\sgl$ of the 
gluing surface, we say that fields in the image of the gluing map
are transverse to $Y$ or splittable along $Y$.
\item There are maps $\cC_{k-1}(Y) \to \cC_k(Y \times I)$, denoted
$c \mapsto c\times I$.
These maps comprise a natural transformation of functors, and commute appropriately
with all the structure maps above (disjoint union, boundary restriction, etc.).
Furthermore, if $f: Y\times I \to Y\times I$ is a fiber-preserving homeomorphism
covering $\bar{f}:Y\to Y$, then $f(c\times I) = \bar{f}(c)\times I$.
\end{enumerate}

There are two notations we commonly use for gluing.
One is 
\[
	x\sgl \deq \gl(x) \in \cC(X\sgl) , 
\]
for $x\in\cC(X)$.
The other is
\[
	x_1\bullet x_2 \deq \gl(x_1\otimes x_2) \in \cC(X\sgl) , 
\]
in the case that $X = X_1 \du X_2$, with $x_i \in \cC(X_i)$.

\medskip

Using the functoriality and $\cdot\times I$ properties above, together
with boundary collar homeomorphisms of manifolds, we can define the notion of 
{\it extended isotopy}.
Let $M$ be an $n$-manifold and $Y \subset \bd M$ be a codimension zero submanifold
of $\bd M$.
Let $x \in \cC(M)$ be a field on $M$ and such that $\bd x$ is splittable along $\bd Y$.
Let $c$ be $x$ restricted to $Y$.
Let $M \cup (Y\times I)$ denote $M$ glued to $Y\times I$ along $Y$.
Then we have the glued field $x \bullet (c\times I)$ on $M \cup (Y\times I)$.
Let $f: M \cup (Y\times I) \to M$ be a collaring homeomorphism.
Then we say that $x$ is {\it extended isotopic} to $f(x \bullet (c\times I))$.
More generally, we define extended isotopy to be the equivalence relation on fields
on $M$ generated by isotopy plus all instance of the above construction
(for all appropriate $Y$ and $x$).

\nn{should also say something about pseudo-isotopy}


\nn{remark that if top dimensional fields are not already linear
then we will soon linearize them(?)}

We now describe in more detail systems of fields coming from sub-cell-complexes labeled
by $n$-category morphisms.

Given an $n$-category $C$ with the right sort of duality
(e.g. pivotal 2-category, 1-category with duals, star 1-category, disklike $n$-category),
we can construct a system of fields as follows.
Roughly speaking, $\cC(X)$ will the set of all embedded cell complexes in $X$
with codimension $i$ cells labeled by $i$-morphisms of $C$.
We'll spell this out for $n=1,2$ and then describe the general case.

If $X$ has boundary, we require that the cell decompositions are in general
position with respect to the boundary --- the boundary intersects each cell
transversely, so cells meeting the boundary are mere half-cells.

Put another way, the cell decompositions we consider are dual to standard cell
decompositions of $X$.

We will always assume that our $n$-categories have linear $n$-morphisms.

For $n=1$, a field on a 0-manifold $P$ is a labeling of each point of $P$ with
an object (0-morphism) of the 1-category $C$.
A field on a 1-manifold $S$ consists of
\begin{itemize}
    \item A cell decomposition of $S$ (equivalently, a finite collection
of points in the interior of $S$);
    \item a labeling of each 1-cell (and each half 1-cell adjacent to $\bd S$)
by an object (0-morphism) of $C$;
    \item a transverse orientation of each 0-cell, thought of as a choice of
``domain" and ``range" for the two adjacent 1-cells; and
    \item a labeling of each 0-cell by a morphism (1-morphism) of $C$, with
domain and range determined by the transverse orientation and the labelings of the 1-cells.
\end{itemize}

If $C$ is an algebra (i.e. if $C$ has only one 0-morphism) we can ignore the labels
of 1-cells, so a field on a 1-manifold $S$ is a finite collection of points in the
interior of $S$, each transversely oriented and each labeled by an element (1-morphism)
of the algebra.

\medskip

For $n=2$, fields are just the sort of pictures based on 2-categories (e.g.\ tensor categories)
that are common in the literature.
We describe these carefully here.

A field on a 0-manifold $P$ is a labeling of each point of $P$ with
an object of the 2-category $C$.
A field of a 1-manifold is defined as in the $n=1$ case, using the 0- and 1-morphisms of $C$.
A field on a 2-manifold $Y$ consists of
\begin{itemize}
    \item A cell decomposition of $Y$ (equivalently, a graph embedded in $Y$ such
that each component of the complement is homeomorphic to a disk);
    \item a labeling of each 2-cell (and each partial 2-cell adjacent to $\bd Y$)
by a 0-morphism of $C$;
    \item a transverse orientation of each 1-cell, thought of as a choice of
``domain" and ``range" for the two adjacent 2-cells;
    \item a labeling of each 1-cell by a 1-morphism of $C$, with
domain and range determined by the transverse orientation of the 1-cell
and the labelings of the 2-cells;
    \item for each 0-cell, a homeomorphism of the boundary $R$ of a small neighborhood
of the 0-cell to $S^1$ such that the intersections of the 1-cells with $R$ are not mapped
to $\pm 1 \in S^1$; and
    \item a labeling of each 0-cell by a 2-morphism of $C$, with domain and range
determined by the labelings of the 1-cells and the parameterizations of the previous
bullet.
\end{itemize}
\nn{need to say this better; don't try to fit everything into the bulleted list}

For general $n$, a field on a $k$-manifold $X^k$ consists of
\begin{itemize}
    \item A cell decomposition of $X$;
    \item an explicit general position homeomorphism from the link of each $j$-cell
to the boundary of the standard $(k-j)$-dimensional bihedron; and
    \item a labeling of each $j$-cell by a $(k-j)$-dimensional morphism of $C$, with
domain and range determined by the labelings of the link of $j$-cell.
\end{itemize}

%\nn{next definition might need some work; I think linearity relations should
%be treated differently (segregated) from other local relations, but I'm not sure
%the next definition is the best way to do it}

\medskip

For top dimensional ($n$-dimensional) manifolds, we're actually interested
in the linearized space of fields.
By default, define $\lf(X) = \c[\cC(X)]$; that is, $\lf(X)$ is
the vector space of finite
linear combinations of fields on $X$.
If $X$ has boundary, we of course fix a boundary condition: $\lf(X; a) = \c[\cC(X; a)]$.
Thus the restriction (to boundary) maps are well defined because we never
take linear combinations of fields with differing boundary conditions.

In some cases we don't linearize the default way; instead we take the
spaces $\lf(X; a)$ to be part of the data for the system of fields.
In particular, for fields based on linear $n$-category pictures we linearize as follows.
Define $\lf(X; a) = \c[\cC(X; a)]/K$, where $K$ is the space generated by
obvious relations on 0-cell labels.
More specifically, let $L$ be a cell decomposition of $X$
and let $p$ be a 0-cell of $L$.
Let $\alpha_c$ and $\alpha_d$ be two labelings of $L$ which are identical except that
$\alpha_c$ labels $p$ by $c$ and $\alpha_d$ labels $p$ by $d$.
Then the subspace $K$ is generated by things of the form
$\lambda \alpha_c + \alpha_d - \alpha_{\lambda c + d}$, where we leave it to the reader
to infer the meaning of $\alpha_{\lambda c + d}$.
Note that we are still assuming that $n$-categories have linear spaces of $n$-morphisms.

\nn{Maybe comment further: if there's a natural basis of morphisms, then no need;
will do something similar below; in general, whenever a label lives in a linear
space we do something like this; ? say something about tensor
product of all the linear label spaces?  Yes:}

For top dimensional ($n$-dimensional) manifolds, we linearize as follows.
Define an ``almost-field" to be a field without labels on the 0-cells.
(Recall that 0-cells are labeled by $n$-morphisms.)
To each unlabeled 0-cell in an almost field there corresponds a (linear) $n$-morphism
space determined by the labeling of the link of the 0-cell.
(If the 0-cell were labeled, the label would live in this space.)
We associate to each almost-labeling the tensor product of these spaces (one for each 0-cell).
We now define $\lf(X; a)$ to be the direct sum over all almost labelings of the
above tensor products.



\subsection{Local relations}
\label{sec:local-relations}


A {\it local relation} is a collection subspaces $U(B; c) \sub \lf(B; c)$,
for all $n$-manifolds $B$ which are
homeomorphic to the standard $n$-ball and all $c \in \cC(\bd B)$, 
satisfying the following properties.
\begin{enumerate}
\item functoriality: 
$f(U(B; c)) = U(B', f(c))$ for all homeomorphisms $f: B \to B'$
\item local relations imply extended isotopy: 
if $x, y \in \cC(B; c)$ and $x$ is extended isotopic 
to $y$, then $x-y \in U(B; c)$.
\item ideal with respect to gluing:
if $B = B' \cup B''$, $x\in U(B')$, and $c\in \cC(B'')$, then $x\bullet r \in U(B)$
\end{enumerate}
See \cite{kw:tqft} for details.


For maps into spaces, $U(B; c)$ is generated by things of the form $a-b \in \lf(B; c)$,
where $a$ and $b$ are maps (fields) which are homotopic rel boundary.

For $n$-category pictures, $U(B; c)$ is equal to the kernel of the evaluation map
$\lf(B; c) \to \mor(c', c'')$, where $(c', c'')$ is some (any) division of $c$ into
domain and range.

\nn{maybe examples of local relations before general def?}

\subsection{Constructing a TQFT}

In this subsection we briefly review the construction of a TQFT from a system of fields and local relations.
(For more details, see \cite{kw:tqft}.)

Let $W$ be an $n{+}1$-manifold.
We can think of the path integral $Z(W)$ as assigning to each
boundary condition $x\in \cC(\bd W)$ a complex number $Z(W)(x)$.
In other words, $Z(W)$ lies in $\c^{\lf(\bd W)}$, the vector space of linear
maps $\lf(\bd W)\to \c$.

The locality of the TQFT implies that $Z(W)$ in fact lies in a subspace
$Z(\bd W) \sub \c^{\lf(\bd W)}$ defined by local projections.
The linear dual to this subspace, $A(\bd W) = Z(\bd W)^*$,
can be thought of as finite linear combinations of fields modulo local relations.
(In other words, $A(\bd W)$ is a sort of generalized skein module.)
This is the motivation behind the definition of fields and local relations above.

In more detail, let $X$ be an $n$-manifold.
%To harmonize notation with the next section, 
%let $\bc_0(X)$ be the vector space of finite linear combinations of fields on $X$, so
%$\bc_0(X) = \lf(X)$.
Define $U(X) \sub \lf(X)$ to be the space of local relations in $\lf(X)$;
$U(X)$ is generated by things of the form $u\bullet r$, where
$u\in U(B)$ for some embedded $n$-ball $B\sub X$ and $r\in \cC(X\setmin B)$.
Define
\[
	A(X) \deq \lf(X) / U(X) .
\]
(The blob complex, defined in the next section, 
is in some sense the derived version of $A(X)$.)
If $X$ has boundary we can similarly define $A(X; c)$ for each 
boundary condition $c\in\cC(\bd X)$.

The above construction can be extended to higher codimensions, assigning
a $k$-category $A(Y)$ to an $n{-}k$-manifold $Y$, for $0 \le k \le n$.
These invariants fit together via actions and gluing formulas.
We describe only the case $k=1$ below.
(The construction of the $n{+}1$-dimensional part of the theory (the path integral) 
requires that the starting data (fields and local relations) satisfy additional
conditions.
We do not assume these conditions here, so when we say ``TQFT" we mean a decapitated TQFT
that lacks its $n{+}1$-dimensional part.)

Let $Y$ be an $n{-}1$-manifold.
Define a (linear) 1-category $A(Y)$ as follows.
The objects of $A(Y)$ are $\cC(Y)$.
The morphisms from $a$ to $b$ are $A(Y\times I; a, b)$, where $a$ and $b$ label the two boundary components of the cylinder $Y\times I$.
Composition is given by gluing of cylinders.

Let $X$ be an $n$-manifold with boundary and consider the collection of vector spaces
$A(X; \cdot) \deq \{A(X; c)\}$ where $c$ ranges through $\cC(\bd X)$.
This collection of vector spaces affords a representation of the category $A(\bd X)$, where
the action is given by gluing a collar $\bd X\times I$ to $X$.

Given a splitting $X = X_1 \cup_Y X_2$ of a closed $n$-manifold $X$ along an $n{-}1$-manifold $Y$,
we have left and right actions of $A(Y)$ on $A(X_1; \cdot)$ and $A(X_2; \cdot)$.
The gluing theorem for $n$-manifolds states that there is a natural isomorphism
\[
	A(X) \cong A(X_1; \cdot) \otimes_{A(Y)} A(X_2; \cdot) .
\]


\section{The blob complex}
\label{sec:blob-definition}

Let $X$ be an $n$-manifold.
Assume a fixed system of fields and local relations.
In this section we will usually suppress boundary conditions on $X$ from the notation
(e.g. write $\lf(X)$ instead of $\lf(X; c)$).

We want to replace the quotient
\[
	A(X) \deq \lf(X) / U(X)
\]
of the previous section with a resolution
\[
	\cdots \to \bc_2(X) \to \bc_1(X) \to \bc_0(X) .
\]

We will define $\bc_0(X)$, $\bc_1(X)$ and $\bc_2(X)$, then give the general case $\bc_k(X)$.

We of course define $\bc_0(X) = \lf(X)$.
(If $X$ has nonempty boundary, instead define $\bc_0(X; c) = \lf(X; c)$.
We'll omit this sort of detail in the rest of this section.)
In other words, $\bc_0(X)$ is just the space of all linearized fields on $X$.

$\bc_1(X)$ is, roughly, the space of all local relations that can be imposed on $\bc_0(X)$.
Less roughly (but still not the official definition), $\bc_1(X)$ is finite linear
combinations of 1-blob diagrams, where a 1-blob diagram to consists of
\begin{itemize}
\item An embedded closed ball (``blob") $B \sub X$.
\item A field $r \in \cC(X \setmin B; c)$
(for some $c \in \cC(\bd B) = \cC(\bd(X \setmin B))$).
\item A local relation field $u \in U(B; c)$
(same $c$ as previous bullet).
\end{itemize}
(See Figure \ref{blob1diagram}.)
\begin{figure}[!ht]\begin{equation*}
\mathfig{.9}{tempkw/blob1diagram}
\end{equation*}\caption{A 1-blob diagram.}\label{blob1diagram}\end{figure}
In order to get the linear structure correct, we (officially) define
\[
	\bc_1(X) \deq \bigoplus_B \bigoplus_c U(B; c) \otimes \lf(X \setmin B; c) .
\]
The first direct sum is indexed by all blobs $B\subset X$, and the second
by all boundary conditions $c \in \cC(\bd B)$.
Note that $\bc_1(X)$ is spanned by 1-blob diagrams $(B, u, r)$.

Define the boundary map $\bd : \bc_1(X) \to \bc_0(X)$ by 
\[ 
	(B, u, r) \mapsto u\bullet r, 
\]
where $u\bullet r$ denotes the linear
combination of fields on $X$ obtained by gluing $u$ to $r$.
In other words $\bd : \bc_1(X) \to \bc_0(X)$ is given by
just erasing the blob from the picture
(but keeping the blob label $u$).

Note that the skein space $A(X)$
is naturally isomorphic to $\bc_0(X)/\bd(\bc_1(X))) = H_0(\bc_*(X))$.

$\bc_2(X)$ is, roughly, the space of all relations (redundancies) among the 
local relations encoded in $\bc_1(X)$.
More specifically, $\bc_2(X)$ is the space of all finite linear combinations of
2-blob diagrams, of which there are two types, disjoint and nested.

A disjoint 2-blob diagram consists of
\begin{itemize}
\item A pair of closed balls (blobs) $B_0, B_1 \sub X$ with disjoint interiors.
\item A field $r \in \cC(X \setmin (B_0 \cup B_1); c_0, c_1)$
(where $c_i \in \cC(\bd B_i)$).
\item Local relation fields $u_i \in U(B_i; c_i)$, $i=1,2$.
\end{itemize}
(See Figure \ref{blob2ddiagram}.)
\begin{figure}[!ht]\begin{equation*}
\mathfig{.9}{tempkw/blob2ddiagram}
\end{equation*}\caption{A disjoint 2-blob diagram.}\label{blob2ddiagram}\end{figure}
We also identify $(B_0, B_1, u_0, u_1, r)$ with $-(B_1, B_0, u_1, u_0, r)$;
reversing the order of the blobs changes the sign.
Define $\bd(B_0, B_1, u_0, u_1, r) = 
(B_1, u_1, u_0\bullet r) - (B_0, u_0, u_1\bullet r) \in \bc_1(X)$.
In other words, the boundary of a disjoint 2-blob diagram
is the sum (with alternating signs)
of the two ways of erasing one of the blobs.
It's easy to check that $\bd^2 = 0$.

A nested 2-blob diagram consists of
\begin{itemize}
\item A pair of nested balls (blobs) $B_0 \sub B_1 \sub X$.
\item A field $r \in \cC(X \setmin B_0; c_0)$
(for some $c_0 \in \cC(\bd B_0)$), which is splittable along $\bd B_1$.
\item A local relation field $u_0 \in U(B_0; c_0)$.
\end{itemize}
(See Figure \ref{blob2ndiagram}.)
\begin{figure}[!ht]\begin{equation*}
\mathfig{.9}{tempkw/blob2ndiagram}
\end{equation*}\caption{A nested 2-blob diagram.}\label{blob2ndiagram}\end{figure}
Let $r = r_1 \bullet r'$, where $r_1 \in \cC(B_1 \setmin B_0; c_0, c_1)$
(for some $c_1 \in \cC(B_1)$) and
$r' \in \cC(X \setmin B_1; c_1)$.
Define $\bd(B_0, B_1, u_0, r) = (B_1, u_0\bullet r_1, r') - (B_0, u_0, r)$.
Note that the requirement that
local relations are an ideal with respect to gluing guarantees that $u_0\bullet r_1 \in U(B_1)$.
As in the disjoint 2-blob case, the boundary of a nested 2-blob is the alternating
sum of the two ways of erasing one of the blobs.
If we erase the inner blob, the outer blob inherits the label $u_0\bullet r_1$.
It is again easy to check that $\bd^2 = 0$.

As with the 1-blob diagrams, in order to get the linear structure correct it is better to define
(officially)
\begin{eqnarray*}
	\bc_2(X) & \deq &
	\left( 
		\bigoplus_{B_0, B_1 \text{disjoint}} \bigoplus_{c_0, c_1}
			U(B_0; c_0) \otimes U(B_1; c_1) \otimes \lf(X\setmin (B_0\cup B_1); c_0, c_1)
	\right) \\
	&& \bigoplus \left( 
		\bigoplus_{B_0 \subset B_1} \bigoplus_{c_0}
			U(B_0; c_0) \otimes \lf(X\setmin B_0; c_0)
	\right) .
\end{eqnarray*}
The final $\lf(X\setmin B_0; c_0)$ above really means fields splittable along $\bd B_1$,
but we didn't feel like introducing a notation for that.
For the disjoint blobs, reversing the ordering of $B_0$ and $B_1$ introduces a minus sign
(rather than a new, linearly independent 2-blob diagram).

Now for the general case.
A $k$-blob diagram consists of
\begin{itemize}
\item A collection of blobs $B_i \sub X$, $i = 0, \ldots, k-1$.
For each $i$ and $j$, we require that either $B_i$ and $B_j$have disjoint interiors or
$B_i \sub B_j$ or $B_j \sub B_i$.
(The case $B_i = B_j$ is allowed.
If $B_i \sub B_j$ the boundaries of $B_i$ and $B_j$ are allowed to intersect.)
If a blob has no other blobs strictly contained in it, we call it a twig blob.
\item Fields (boundary conditions) $c_i \in \cC(\bd B_i)$.
(These are implied by the data in the next bullets, so we usually
suppress them from the notation.)
$c_i$ and $c_j$ must have identical restrictions to $\bd B_i \cap \bd B_j$
if the latter space is not empty.
\item A field $r \in \cC(X \setmin B^t; c^t)$,
where $B^t$ is the union of all the twig blobs and $c^t \in \cC(\bd B^t)$
is determined by the $c_i$'s.
$r$ is required to be splittable along the boundaries of all blobs, twigs or not.
\item For each twig blob $B_j$ a local relation field $u_j \in U(B_j; c_j)$,
where $c_j$ is the restriction of $c^t$ to $\bd B_j$.
If $B_i = B_j$ then $u_i = u_j$.
\end{itemize}
(See Figure \ref{blobkdiagram}.)
\begin{figure}[!ht]\begin{equation*}
\mathfig{.9}{tempkw/blobkdiagram}
\end{equation*}\caption{A $k$-blob diagram.}\label{blobkdiagram}\end{figure}

If two blob diagrams $D_1$ and $D_2$ 
differ only by a reordering of the blobs, then we identify
$D_1 = \pm D_2$, where the sign is the sign of the permutation relating $D_1$ and $D_2$.

$\bc_k(X)$ is, roughly, all finite linear combinations of $k$-blob diagrams.
As before, the official definition is in terms of direct sums
of tensor products:
\[
	\bc_k(X) \deq \bigoplus_{\overline{B}} \bigoplus_{\overline{c}}
		\left( \otimes_j U(B_j; c_j)\right) \otimes \lf(X \setmin B^t; c^t) .
\]
Here $\overline{B}$ runs over all configurations of blobs, satisfying the conditions above.
$\overline{c}$ runs over all boundary conditions, again as described above.
$j$ runs over all indices of twig blobs. The final $\lf(X \setmin B^t; c^t)$ must be interpreted as fields which are splittable along all of the blobs in $\overline{B}$.

The boundary map $\bd : \bc_k(X) \to \bc_{k-1}(X)$ is defined as follows.
Let $b = (\{B_i\}, \{u_j\}, r)$ be a $k$-blob diagram.
Let $E_j(b)$ denote the result of erasing the $j$-th blob.
If $B_j$ is not a twig blob, this involves only decrementing
the indices of blobs $B_{j+1},\ldots,B_{k-1}$.
If $B_j$ is a twig blob, we have to assign new local relation labels
if removing $B_j$ creates new twig blobs.
If $B_l$ becomes a twig after removing $B_j$, then set $u_l = u_j\bullet r_l$,
where $r_l$ is the restriction of $r$ to $B_l \setmin B_j$.
Finally, define
\eq{
    \bd(b) = \sum_{j=0}^{k-1} (-1)^j E_j(b).
}
The $(-1)^j$ factors imply that the terms of $\bd^2(b)$ all cancel.
Thus we have a chain complex.

\nn{?? say something about the ``shape" of tree? (incl = cone, disj = product)}

\nn{?? remark about dendroidal sets}


