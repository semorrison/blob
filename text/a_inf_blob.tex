%!TEX root = ../blob1.tex

\section{The blob complex for $A_\infty$ $n$-categories}
\label{sec:ainfblob}
Given an $A_\infty$ $n$-category $\cC$ and an $n$-manifold $M$, we make the anticlimactically tautological definition of the blob
complex $\bc_*(M;\cC)$ to be the homotopy colimit $\cl{\cC}(M)$ of \S\ref{ss:ncat_fields}.

We will show below 
in Corollary \ref{cor:new-old}
that when $\cC$ is obtained from a topological $n$-category $\cD$ as the blob complex of a point, this agrees (up to homotopy) with our original definition of the blob complex
for $\cD$.

An important technical tool in the proofs of this section is provided by the idea of `small blobs'.
Fix $\cU$, an open cover of $M$.
Define the `small blob complex' $\bc^{\cU}_*(M)$ to be the subcomplex of $\bc_*(M)$ of all blob diagrams in which every blob is contained in some open set of $\cU$, and moreover each field labeling a region cut out by the blobs is splittable into fields on smaller regions, each of which is contained in some open set.

\begin{thm}[Small blobs] \label{thm:small-blobs}
The inclusion $i: \bc^{\cU}_*(M) \into \bc_*(M)$ is a homotopy equivalence.
\end{thm}
The proof appears in \S \ref{appendix:small-blobs}.

\subsection{A product formula}
\label{ss:product-formula}

\noop{
Let $Y$ be a $k$-manifold, $F$ be an $n{-}k$-manifold, and 
\[
	E = Y\times F .
\]
Let $\cC$ be an $n$-category.
Let $\cF$ be the $k$-category of Example \ref{ex:blob-complexes-of-balls}, 
\[
	\cF(X) = \cC(X\times F)
\]
for $X$ an $m$-ball with $m\le k$.
}

\nn{need to settle on notation; proof and statement are inconsistent}

\begin{thm} \label{thm:product}
Given a topological $n$-category $C$ and a $n{-}k$-manifold $F$, recall from 
Example \ref{ex:blob-complexes-of-balls} that there is an  $A_\infty$ $k$-category $\bc_*(F; C)$ defined by
\begin{equation*}
\bc_*(F; C)(B) = \cB_*(F \times B; C).
\end{equation*}
Now, given a $k$-manifold $Y$, there is a homotopy equivalence between the ``old-fashioned'' 
blob complex for $Y \times F$ with coefficients in $C$ and the ``new-fangled" 
(i.e.\ homotopy colimit) blob complex for $Y$ with coefficients in $\bc_*(F; C)$:
\begin{align*}
\cB_*(Y \times F; C) & \htpy \cl{\bc_*(F; C)}(Y)
\end{align*}
\end{thm}


\begin{proof}
We will use the concrete description of the colimit from \S\ref{ss:ncat_fields}.

First we define a map 
\[
	\psi: \cl{\bc_*(F; C)}(Y) \to \bc_*(Y\times F;C) .
\]
In filtration degree 0 we just glue together the various blob diagrams on $X_i\times F$
(where $X_i$ is a component of a permissible decomposition of $Y$) to get a blob diagram on
$Y\times F$.
In filtration degrees 1 and higher we define the map to be zero.
It is easy to check that this is a chain map.

In the other direction, we will define a subcomplex $G_*\sub \bc_*(Y\times F;C)$
and a map
\[
	\phi: G_* \to \cl{\bc_*(F; C)}(Y) .
\]

Given a decomposition $K$ of $Y$ into $k$-balls $X_i$, let $K\times F$ denote the corresponding
decomposition of $Y\times F$ into the pieces $X_i\times F$.

Let $G_*\sub \bc_*(Y\times F;C)$ be the subcomplex generated by blob diagrams $a$ such that there
exists a decomposition $K$ of $Y$ such that $a$ splits along $K\times F$.
It follows from Proposition \ref{thm:small-blobs} that $\bc_*(Y\times F; C)$ is homotopic to a subcomplex of $G_*$.
(If the blobs of $a$ are small with respect to a sufficiently fine cover then their
projections to $Y$ are contained in some disjoint union of balls.)
Note that the image of $\psi$ is equal to $G_*$.

We will define $\phi: G_* \to \cl{\bc_*(F; C)}(Y)$ using the method of acyclic models.
Let $a$ be a generator of $G_*$.
Let $D(a)$ denote the subcomplex of $\cl{\bc_*(F; C)}(Y)$ generated by all $(b, \ol{K})$
such that $a$ splits along $K_0\times F$ and $b$ is a generator appearing
in an iterated boundary of $a$ (this includes $a$ itself).
(Recall that $\ol{K} = (K_0,\ldots,K_l)$ denotes a chain of decompositions;
see \S\ref{ss:ncat_fields}.)
By $(b, \ol{K})$ we really mean $(b^\sharp, \ol{K})$, where $b^\sharp$ is 
$b$ split according to $K_0\times F$.
To simplify notation we will just write plain $b$ instead of $b^\sharp$.
Roughly speaking, $D(a)$ consists of filtration degree 0 stuff which glues up to give
$a$ (or one of its iterated boundaries), filtration degree 1 stuff which makes all of the filtration degree 0 stuff homologous, 
filtration degree 2 stuff which kills the homology created by the 
filtration degree 1 stuff, and so on.
More formally,
 
\begin{lemma} \label{lem:d-a-acyclic}
$D(a)$ is acyclic.
\end{lemma}

\begin{proof}
We will prove acyclicity in the first couple of degrees, and \nn{in this draft, at least}
leave the general case to the reader.

Let $K$ and $K'$ be two decompositions of $Y$ compatible with $a$.
We want to show that $(a, K)$ and $(a, K')$ are homologous via filtration degree 1 stuff.
\nn{need to say this better; these two chains don't have the same boundary.}
We might hope that $K$ and $K'$ have a common refinement, but this is not necessarily
the case.
(Consider the $x$-axis and the graph of $y = x^2\sin(1/x)$ in $\r^2$.)
However, we {\it can} find another decomposition $L$ such that $L$ shares common
refinements with both $K$ and $K'$.
Let $KL$ and $K'L$ denote these two refinements.
Then filtration degree 1 chains associated to the four anti-refinements
$KL\to K$, $KL\to L$, $K'L\to L$ and $K'L\to K'$
give the desired chain connecting $(a, K)$ and $(a, K')$
(see Figure \ref{zzz4}).

\begin{figure}[!ht]
\begin{equation*}
\begin{tikzpicture}
\foreach \x/\label in {-3/K, 0/L, 3/K'} {
	\node(\label) at (\x,0) {$\label$};
}
\foreach \x/\la/\lb in {-1.5/K/L, 1.5/K'/L} {
	\node(\la \lb) at (\x,-1.5) {$\la \lb$};
	\draw[->] (\la \lb) -- (\la);
	\draw[->] (\la \lb) -- (\lb); 
}
\end{tikzpicture}
\end{equation*}
\caption{Connecting $K$ and $K'$ via $L$}
\label{zzz4}
\end{figure}

Consider a different choice of decomposition $L'$ in place of $L$ above.
This leads to a cycle consisting of filtration degree 1 stuff.
We want to show that this cycle bounds a chain of filtration degree 2 stuff.
Choose a decomposition $M$ which has common refinements with each of 
$K$, $KL$, $L$, $K'L$, $K'$, $K'L'$, $L'$ and $KL'$.
(We also also require that $KLM$ antirefines to $KM$, etc.)
Then we have a filtration degree 2 chain, as shown in Figure \ref{zzz5}, which does the trick.
(Each small triangle in Figure \ref{zzz5} can be filled with a filtration degree 2 chain.)

\begin{figure}[!ht]
%\begin{equation*}
%\mathfig{1.0}{tempkw/zz5}
%\end{equation*}
\begin{equation*}
\begin{tikzpicture}
\node(M) at (0,0) {$M$};
\foreach \angle/\label in {0/K', 45/K'L, 90/L, 135/KL, 180/K, 225/KL', 270/L', 315/K'L'} {
	\node(\label) at (\angle:4) {$\label$};
}
\foreach \label in {K', L, K, L'} {
	\node(\label M) at ($(M)!0.6!(\label)$) {$\label M$};
	\draw[->] (\label M)--(M);
	\draw[->] (\label M)--(\label);
}
\foreach \k in {K, K'} {
	\foreach \l in {L, L'} {
		\node(\k \l M) at (intersection cs: first line={(\k M)--(\l)}, second line={(\l M)--(\k)}) {$\k \l M$};
		\draw[->] (\k \l M)--(M);
		\draw[->] (\k \l M)--(\k \l );
		\draw[->] (\k \l M)--(\k M);
		\draw[->] (\k \l M)--(\l);
		\draw[->] (\k \l M)--(\l M);
		\draw[->] (\k \l M)--(\k);
	}
}
\draw[->] (K'L') to[bend right=10] (K');
\draw[->] (K'L') to[bend left=10] (L');
\draw[->] (KL') to[bend left=10] (K);
\draw[->] (KL') to[bend right=10] (L');
\draw[->] (K'L) to[bend left=10] (K');
\draw[->] (K'L) to[bend right=10] (L);
\draw[->] (KL) to[bend right=10] (K);
\draw[->] (KL) to[bend left=10] (L);
\end{tikzpicture}
\end{equation*}
\caption{Filling in $K$-$KL$-$L$-$K'L$-$K'$-$K'L'$-$L'$-$KL'$-$K$}
\label{zzz5}
\end{figure}

Continuing in this way we see that $D(a)$ is acyclic.
\end{proof}

We are now in a position to apply the method of acyclic models to get a map
$\phi:G_* \to \cl{\bc_*(F; C)}(Y)$.
We may assume that $\phi(a)$ has the form $(a, K) + r$, where $(a, K)$ is in filtration degree zero
and $r$ has filtration degree greater than zero.

We now show that $\phi\circ\psi$ and $\psi\circ\phi$ are homotopic to the identity.

First, $\psi\circ\phi$ is the identity on the nose:
\[
	\psi(\phi(a)) = \psi((a,K)) + \psi(r) = a + 0.
\]
Roughly speaking, $(a, K)$ is just $a$ chopped up into little pieces, and 
$\psi$ glues those pieces back together, yielding $a$.
We have $\psi(r) = 0$ since $\psi$ is zero in positive filtration degrees.
 
Second, $\phi\circ\psi$ is the identity up to homotopy by another argument based on the method of acyclic models.
To each generator $(b, \ol{K})$ of $G_*$ we associate the acyclic subcomplex $D(b)$ defined above.
Both the identity map and $\phi\circ\psi$ are compatible with this
collection of acyclic subcomplexes, so by the usual method of acyclic models argument these two maps
are homotopic.

This concludes the proof of Theorem \ref{thm:product}.
\end{proof}

\nn{need to prove a version where $E$ above has dimension $m<n$; result is an $n{-}m$-category}

\medskip

\begin{cor}
\label{cor:new-old}
The blob complex of a manifold $M$ with coefficients in a topological $n$-category $\cC$ is homotopic to the homotopy colimit invariant of $M$ defined using the $A_\infty$ $n$-category obtained by applying the blob complex to a point:
$$\bc_*(M; \cC) \htpy \cl{\bc_*(pt; \cC)}(M).$$ 
\end{cor}
\begin{proof}
Apply Theorem \ref{thm:product} with the fiber $F$ equal to a point.
\end{proof}

\medskip

Theorem \ref{thm:product} extends to the case of general fiber bundles
\[
	F \to E \to Y .
\]
We outline one approach here and a second in Subsection xxxx.

We can generalize the definition of a $k$-category by replacing the categories
of $j$-balls ($j\le k$) with categories of $j$-balls $D$ equipped with a map $p:D\to Y$
(c.f. \cite{MR2079378}).
Call this a $k$-category over $Y$.
A fiber bundle $F\to E\to Y$ gives an example of a $k$-category over $Y$:
assign to $p:D\to Y$ the blob complex $\bc_*(p^*(E))$.
Let $\cF_E$ denote this $k$-category over $Y$.
We can adapt the homotopy colimit construction (based decompositions of $Y$ into balls) to
get a chain complex $\cF_E(Y)$.
The proof of Theorem \ref{thm:product} goes through essentially unchanged 
to show that
\[
	\bc_*(E) \simeq \cF_E(Y) .
\]

\nn{remark further that this still works when the map is not even a fibration?}

\nn{put this later}

\nn{The second approach: Choose a decomposition $Y = \cup X_i$
such that the restriction of $E$ to $X_i$ is a product $F\times X_i$.
Choose the product structure as well.
To each codim-1 face $D_i\cap D_j$ we have a bimodule ($S^0$-module).
And more generally to each codim-$j$ face we have an $S^{j-1}$-module.
Decorate the decomposition with these modules and do the colimit.
}

\nn{There is a version of this last construction for arbitrary maps $E \to Y$
(not necessarily a fibration).
In fact, there is also a version of the first construction for non-fibrations.}



\subsection{A gluing theorem}
\label{sec:gluing}

Next we prove a gluing theorem.
Let $X$ be a closed $k$-manifold with a splitting $X = X'_1\cup_Y X'_2$.
We will need an explicit collar on $Y$, so rewrite this as
$X = X_1\cup (Y\times J) \cup X_2$.
Given this data we have:
\begin{itemize}
\item An $A_\infty$ $n{-}k$-category $\bc(X)$, which assigns to an $m$-ball
$D$ fields on $D\times X$ (for $m+k < n$) or the blob complex $\bc_*(D\times X; c)$
(for $m+k = n$).
(See Example \ref{ex:blob-complexes-of-balls}.)
%\nn{need to explain $c$}.
\item An $A_\infty$ $n{-}k{+}1$-category $\bc(Y)$, defined similarly.
\item Two $\bc(Y)$ modules $\bc(X_1)$ and $\bc(X_2)$, which assign to a marked
$m$-ball $(D, H)$ either fields on $(D\times Y) \cup (H\times X_i)$ (if $m+k < n$)
or the blob complex $\bc_*((D\times Y) \cup (H\times X_i))$ (if $m+k = n$).
(See Example \nn{need example for this}.)
\end{itemize}

\begin{thm}
\label{thm:gluing}
$\bc(X) \simeq \bc(X_1) \otimes_{\bc(Y), J} \bc(X_2)$.
\end{thm}

\begin{proof}
\nn{for now, just prove $k=0$ case.}
The proof is similar to that of Theorem \ref{thm:product}.
We give a short sketch with emphasis on the differences from 
the proof of Theorem \ref{thm:product}.

Let $\cT$ denote the chain complex $\bc(X_1) \otimes_{\bc(Y), J} \bc(X_2)$.
Recall that this is a homotopy colimit based on decompositions of the interval $J$.

We define a map $\psi:\cT\to \bc_*(X)$.
On filtration degree zero summands it is given
by gluing the pieces together to get a blob diagram on $X$.
On filtration degree 1 and greater $\psi$ is zero.

The image of $\psi$ is the subcomplex $G_*\sub \bc(X)$ generated by blob diagrams which split
over some decomposition of $J$.
It follows from Proposition \ref{thm:small-blobs} that $\bc_*(X)$ is homotopic to 
a subcomplex of $G_*$. 

Next we define a map $\phi:G_*\to \cT$ using the method of acyclic models.
As in the proof of Theorem \ref{thm:product}, we assign to a generator $a$ of $G_*$
an acyclic subcomplex which is (roughly) $\psi\inv(a)$.
The proof of acyclicity is easier in this case since any pair of decompositions of $J$ have
a common refinement.

The proof that these two maps are inverse to each other is the same as in
Theorem \ref{thm:product}.
\end{proof}

\noop{
Let $\cT$ denote the $n{-}k$-category $\bc(X_1) \otimes_{\bc(Y), J} \bc(X_2)$.
Let $D$ be an $n{-}k$-ball.
There is an obvious map from $\cT(D)$ to $\bc_*(D\times X)$.
To get a map in the other direction, we replace $\bc_*(D\times X)$ with a subcomplex
$\cS_*$ which is adapted to a fine open cover of $D\times X$.
For sufficiently small $j$ (depending on the cover), we can find, for each $j$-blob diagram $b$
on $D\times X$, a decomposition of $J$ such that $b$ splits on the corresponding
decomposition of $D\times X$.
The proof that these two maps are inverse to each other is the same as in
Theorem \ref{thm:product}.
}


\medskip

\subsection{Reconstructing mapping spaces}
\label{sec:map-recon}

The next theorem shows how to reconstruct a mapping space from local data.
Let $T$ be a topological space, let $M$ be an $n$-manifold, 
and recall the $A_\infty$ $n$-category $\pi^\infty_{\leq n}(T)$ 
of Example \ref{ex:chains-of-maps-to-a-space}.
Think of $\pi^\infty_{\leq n}(T)$ as encoding everything you would ever
want to know about spaces of maps of $k$-balls into $T$ ($k\le n$).
To simplify notation, let $\cT = \pi^\infty_{\leq n}(T)$.

\begin{thm}
\label{thm:map-recon}
The blob complex for $M$ with coefficients in the fundamental $A_\infty$ $n$-category for $T$ 
is quasi-isomorphic to singular chains on maps from $M$ to $T$.
$$\cB^\cT(M) \simeq C_*(\Maps(M\to T)).$$
\end{thm}
\begin{rem}
Lurie has shown in \cite[Theorem 3.8.6]{0911.0018} that the topological chiral homology 
of an $n$-manifold $M$ with coefficients in a certain $E_n$ algebra constructed from $T$ recovers 
the same space of singular chains on maps from $M$ to $T$, with the additional hypothesis that $T$ is $n-1$-connected.
This extra hypothesis is not surprising, in view of the idea described in Example \ref{ex:e-n-alg} 
that an $E_n$ algebra is roughly equivalent data to an $A_\infty$ $n$-category which 
is trivial at all but the topmost level.
Ricardo Andrade also told us about a similar result.
\end{rem}

\begin{proof}
The proof is again similar to that of Theorem \ref{thm:product}.

We begin by constructing chain map $\psi: \cB^\cT(M) \to C_*(\Maps(M\to T))$.

Recall that the homotopy colimit $\cB^\cT(M)$ is constructed out of a series of
$j$-fold mapping cylinders, $j \ge 0$.
So, as an abelian group (but not as a chain complex), 
\[
	\cB^\cT(M) = \bigoplus_{j\ge 0} C^j,
\]
where $C^j$ denotes the new chains introduced by the $j$-fold mapping cylinders.

Recall that $C^0$ is a direct sum of chain complexes with the summands indexed by
decompositions of $M$ which have their $n{-}1$-skeletons labeled by $n{-}1$-morphisms
of $\cT$.
Since $\cT = \pi^\infty_{\leq n}(T)$, this means that the summands are indexed by pairs
$(K, \vphi)$, where $K$ is a decomposition of $M$ and $\vphi$ is a continuous
maps from the $n{-}1$-skeleton of $K$ to $T$.
The summand indexed by $(K, \vphi)$ is
\[
	\bigotimes_b D_*(b, \vphi),
\]
where $b$ runs through the $n$-cells of $K$ and $D_*(b, \vphi)$ denotes
chains of maps from $b$ to $T$ compatible with $\vphi$.
We can take the product of these chains of maps to get a chains of maps from
all of $M$ to $K$.
This defines $\psi$ on $C^0$.

We define $\psi(C^j) = 0$ for $j > 0$.
It is not hard to see that this defines a chain map from 
$\cB^\cT(M)$ to $C_*(\Maps(M\to T))$.

The image of $\psi$ is the subcomplex $G_*\sub C_*(\Maps(M\to T))$ generated by 
families of maps whose support is contained in a disjoint union of balls.
It follows from Lemma \ref{extension_lemma_c} 
that $C_*(\Maps(M\to T))$ is homotopic to a subcomplex of $G_*$.

We will define a map $\phi:G_*\to \cB^\cT(M)$ via acyclic models.
Let $a$ be a generator of $G_*$.
Define $D(a)$ to be the subcomplex of $\cB^\cT(M)$ generated by all 
pairs $(b, \ol{K})$, where $b$ is a generator appearing in an iterated boundary of $a$
and $\ol{K}$ is an index of the homotopy colimit $\cB^\cT(M)$.
(See the proof of Theorem \ref{thm:product} for more details.)
The same proof as of Lemma \ref{lem:d-a-acyclic} shows that $D(a)$ is acyclic.
By the usual acyclic models nonsense, there is a (unique up to homotopy)
map $\phi:G_*\to \cB^\cT(M)$ such that $\phi(a)\in D(a)$.
Furthermore, we may choose $\phi$ such that for all $a$ 
\[
	\phi(a) = (a, K) + r
\]
where $(a, K) \in C^0$ and $r\in \bigoplus_{j\ge 1} C^j$.

It is now easy to see that $\psi\circ\phi$ is the identity on the nose.
Another acyclic models argument shows that $\phi\circ\psi$ is homotopic to the identity.
(See the proof of Theorem \ref{thm:product} for more details.)
\end{proof}

\noop{
% old proof (just start):
We begin by constructing chain map $g: \cB^\cT(M) \to C_*(\Maps(M\to T))$.
We then use Lemma \ref{extension_lemma_c} to show that $g$ induces isomorphisms on homology.

Recall that the homotopy colimit $\cB^\cT(M)$ is constructed out of a series of
$j$-fold mapping cylinders, $j \ge 0$.
So, as an abelian group (but not as a chain complex), 
\[
	\cB^\cT(M) = \bigoplus_{j\ge 0} C^j,
\]
where $C^j$ denotes the new chains introduced by the $j$-fold mapping cylinders.

Recall that $C^0$ is a direct sum of chain complexes with the summands indexed by
decompositions of $M$ which have their $n{-}1$-skeletons labeled by $n{-}1$-morphisms
of $\cT$.
Since $\cT = \pi^\infty_{\leq n}(T)$, this means that the summands are indexed by pairs
$(K, \vphi)$, where $K$ is a decomposition of $M$ and $\vphi$ is a continuous
maps from the $n{-}1$-skeleton of $K$ to $T$.
The summand indexed by $(K, \vphi)$ is
\[
	\bigotimes_b D_*(b, \vphi),
\]
where $b$ runs through the $n$-cells of $K$ and $D_*(b, \vphi)$ denotes
chains of maps from $b$ to $T$ compatible with $\vphi$.
We can take the product of these chains of maps to get a chains of maps from
all of $M$ to $K$.
This defines $g$ on $C^0$.

We define $g(C^j) = 0$ for $j > 0$.
It is not hard to see that this defines a chain map from 
$\cB^\cT(M)$ to $C_*(\Maps(M\to T))$.

\nn{...}
}

\nn{maybe should also mention version where we enrich over
spaces rather than chain complexes;}

\medskip
\hrule
\medskip

\nn{to be continued...}
\medskip
\nn{still to do: general maps}

\todo{}
Various citations we might want to make:
\begin{itemize}
\item \cite{MR2061854} McClure and Smith's review article
\item \cite{MR0420610} May, (inter alia, definition of $E_\infty$ operad)
\item \cite{MR0236922,MR0420609} Boardman and Vogt
\item \cite{MR1256989} definition of framed little-discs operad
\end{itemize}


