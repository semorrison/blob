%!TEX root = ../blob1.tex

\section{The blob complex for $A_\infty$ $n$-categories}
\label{sec:ainfblob}

Given an $A_\infty$ $n$-category $\cC$ and an $n$-manifold $M$, we define the blob
complex $\bc_*(M)$ to the be the homotopy colimit $\cC(M)$ of Section \ref{sec:ncats}.
\nn{say something about this being anticlimatically tautological?}
We will show below 
\nn{give ref}
that this agrees (up to homotopy) with our original definition of the blob complex
in the case of plain $n$-categories.
When we need to distinguish between the new and old definitions, we will refer to the 
new-fangled and old-fashioned blob complex.

\medskip

Let $M^n = Y^k\times F^{n-k}$.  
Let $C$ be a plain $n$-category.
Let $\cF$ be the $A_\infty$ $k$-category which assigns to a $k$-ball
$X$ the old-fashioned blob complex $\bc_*(X\times F)$.

\begin{thm} \label{product_thm}
The old-fashioned blob complex $\bc_*^C(Y\times F)$ is homotopy equivalent to the
new-fangled blob complex $\bc_*^\cF(Y)$.
\end{thm}

\input{text/smallblobs}

\begin{proof}[Proof of Theorem \ref{product_thm}]
We will use the concrete description of the colimit from Subsection \ref{ss:ncat_fields}.

First we define a map 
\[
	\psi: \bc_*^\cF(Y) \to \bc_*^C(Y\times F) .
\]
In filtration degree 0 we just glue together the various blob diagrams on $X\times F$
(where $X$ is a component of a permissible decomposition of $Y$) to get a blob diagram on
$Y\times F$.
In filtration degrees 1 and higher we define the map to be zero.
It is easy to check that this is a chain map.

Next we define a map 
\[
	\phi: \bc_*^C(Y\times F) \to \bc_*^\cF(Y) .
\]
Actually, we will define it on the homotopy equivalent subcomplex
$\cS_* \sub \bc_*^C(Y\times F)$ generated by blob diagrams which are small with 
respect to some open cover
of $Y\times F$.
\nn{need reference to small blob lemma}
We will have to show eventually that this is independent (up to homotopy) of the choice of cover.
Also, for a fixed choice of cover we will only be able to define the map for blob degree less than
some bound, but this bound goes to infinity as the cover become finer.

Given a decomposition $K$ of $Y$ into $k$-balls $X_i$, let $K\times F$ denote the corresponding
decomposition of $Y\times F$ into the pieces $X_i\times F$.

%We will define $\phi$ inductively, starting at blob degree 0.
%Given a 0-blob diagram $x$ on $Y\times F$, we can choose a decomposition $K$ of $Y$
%such that $x$ is splittable with respect to $K\times F$.
%This defines a filtration degree 0 element of $\bc_*^\cF(Y)$

We will define $\phi$ using a variant of the method of acyclic models.
Let $a\in \cS_m$ be a blob diagram on $Y\times F$.
For $m$ sufficiently small there exists a decomposition $K$ of $Y$ into $k$-balls such that the
codimension 1 cells of $K\times F$ miss the blobs of $a$, and more generally such that $a$ is splittable along (the codimension-1 part of) $K\times F$.
Let $D(a)$ denote the subcomplex of $\bc_*^\cF(Y)$ generated by all $(a, \bar{K})$
such that each $K_i$ has the aforementioned splittable property
(see Subsection \ref{ss:ncat_fields}).
\nn{need to define $D(a)$ more clearly; also includes $(b_j, \bar{K})$ where
$\bd(a) = \sum b_j$.}
(By $(a, \bar{K})$ we really mean $(a^\sharp, \bar{K})$, where $a^\sharp$ is 
$a$ split according to $K_0\times F$.
To simplify notation we will just write plain $a$ instead of $a^\sharp$.)
Roughly speaking, $D(a)$ consists of filtration degree 0 stuff which glues up to give
$a$, filtration degree 1 stuff which makes all of the filtration degree 0 stuff homologous, 
filtration degree 2 stuff which kills the homology created by the 
filtration degree 1 stuff, and so on.
More formally,
 
\begin{lemma}
$D(a)$ is acyclic.
\end{lemma}

\begin{proof}
We will prove acyclicity in the first couple of degrees, and \nn{in this draft, at least}
leave the general case to the reader.

Let $K$ and $K'$ be two decompositions of $Y$ compatible with $a$.
We want to show that $(a, K)$ and $(a, K')$ are homologous via filtration degree 1 stuff.
\nn{need to say this better; these two chains don't have the same boundary.}
We might hope that $K$ and $K'$ have a common refinement, but this is not necessarily
the case.
(Consider the $x$-axis and the graph of $y = x^2\sin(1/x)$ in $\r^2$.)
However, we {\it can} find another decomposition $L$ such that $L$ shares common
refinements with both $K$ and $K'$.
Let $KL$ and $K'L$ denote these two refinements.
Then filtration degree 1 chains associated to the four anti-refinemnts
$KL\to K$, $KL\to L$, $K'L\to L$ and $K'L\to K'$
give the desired chain connecting $(a, K)$ and $(a, K')$
(see Figure \ref{zzz4}).

\begin{figure}[!ht]
\begin{equation*}
\begin{tikzpicture}
\foreach \x/\label in {-3/K, 0/L, 3/K'} {
	\node(\label) at (\x,0) {$\label$};
}
\foreach \x/\la/\lb in {-1.5/K/L, 1.5/K'/L} {
	\node(\la \lb) at (\x,-1.5) {$\la \lb$};
	\draw[->] (\la \lb) -- (\la);
	\draw[->] (\la \lb) -- (\lb); 
}
\end{tikzpicture}
\end{equation*}
\caption{Connecting $K$ and $K'$ via $L$}
\label{zzz4}
\end{figure}

Consider a different choice of decomposition $L'$ in place of $L$ above.
This leads to a cycle consisting of filtration degree 1 stuff.
We want to show that this cycle bounds a chain of filtration degree 2 stuff.
Choose a decomposition $M$ which has common refinements with each of 
$K$, $KL$, $L$, $K'L$, $K'$, $K'L'$, $L'$ and $KL'$.
\nn{need to also require that $KLM$ antirefines to $KM$, etc.}
Then we have a filtration degree 2 chain, as shown in Figure \ref{zzz5}, which does the trick.
(Each small triangle in Figure \ref{zzz5} can be filled with a filtration degree 2 chain.)

\begin{figure}[!ht]
%\begin{equation*}
%\mathfig{1.0}{tempkw/zz5}
%\end{equation*}
\begin{equation*}
\begin{tikzpicture}
\node(M) at (0,0) {$M$};
\foreach \angle/\label in {0/K', 45/K'L, 90/L, 135/KL, 180/K, 225/KL', 270/L', 315/K'L'} {
	\node(\label) at (\angle:4) {$\label$};
}
\foreach \label in {K', L, K, L'} {
	\node(\label M) at ($(M)!0.6!(\label)$) {$\label M$};
	\draw[->] (\label M)--(M);
	\draw[->] (\label M)--(\label);
}
\foreach \k in {K, K'} {
	\foreach \l in {L, L'} {
		\node(\k \l M) at (intersection cs: first line={(\k M)--(\l)}, second line={(\l M)--(\k)}) {$\k \l M$};
		\draw[->] (\k \l M)--(M);
		\draw[->] (\k \l M)--(\k \l );
		\draw[->] (\k \l M)--(\k M);
		\draw[->] (\k \l M)--(\l);
		\draw[->] (\k \l M)--(\l M);
		\draw[->] (\k \l M)--(\k);
	}
}
\draw[->] (K'L') to[bend right=10] (K');
\draw[->] (K'L') to[bend left=10] (L');
\draw[->] (KL') to[bend left=10] (K);
\draw[->] (KL') to[bend right=10] (L');
\draw[->] (K'L) to[bend left=10] (K');
\draw[->] (K'L) to[bend right=10] (L);
\draw[->] (KL) to[bend right=10] (K);
\draw[->] (KL) to[bend left=10] (L);
\end{tikzpicture}
\end{equation*}
\caption{Filling in $K$-$KL$-$L$-$K'L$-$K'$-$K'L'$-$L'$-$KL'$-$K$}
\label{zzz5}
\end{figure}

Continuing in this way we see that $D(a)$ is acyclic.
\end{proof}

We are now in a position to apply the method of acyclic models to get a map
$\phi:\cS_* \to \bc_*^\cF(Y)$.
This map is defined in sufficiently low degrees, sends a blob diagram $a$ to $D(a)$, 
and is well-defined up to (iterated) homotopy.

The subcomplex $\cS_* \subset \bc_*^C(Y\times F)$ depends on choice of cover of $Y\times F$.
If we refine that cover, we get a complex $\cS'_* \subset \cS_*$
and a map $\phi':\cS'_* \to \bc_*^\cF(Y)$.
$\phi'$ is defined only on homological degrees below some bound, but this bound is higher than 
the corresponding bound for $\phi$.
We must show that $\phi$ and $\phi'$ agree, up to homotopy,
on the intersection of the subcomplexes on which they are defined.
This is clear, since the acyclic subcomplexes $D(a)$ above used in the definition of 
$\phi$ and $\phi'$ do not depend on the choice of cover.

\nn{need to say (and justify) that we now have a map $\phi$ indep of choice of cover}

We now show that $\phi\circ\psi$ and $\psi\circ\phi$ are homotopic to the identity.

$\psi\circ\phi$ is the identity.  $\phi$ takes a blob diagram $a$ and chops it into pieces 
according to some decomposition $K$ of $Y$.
$\psi$ glues those pieces back together, yielding the same $a$ we started with.

$\phi\circ\psi$ is the identity up to homotopy by another MoAM argument...

This concludes the proof of Theorem \ref{product_thm}.
\nn{at least I think it does; it's pretty rough at this point.}
\end{proof}

\nn{need to say something about dim $< n$ above}

\medskip

\begin{cor}
The new-fangled and old-fashioned blob complexes are homotopic.
\end{cor}
\begin{proof}
Apply Theorem \ref{product_thm} with the fiber $F$ equal to a point.
\end{proof}

\medskip

Next we prove a gluing theorem.
Let $X$ be a closed $k$-manifold with a splitting $X = X'_1\cup_Y X'_2$.
We will need an explicit collar on $Y$, so rewrite this as
$X = X_1\cup (Y\times J) \cup X_2$.
\nn{need figure}
Given this data we have: \nn{need refs to above for these}
\begin{itemize}
\item An $A_\infty$ $n{-}k$-category $\bc(X)$, which assigns to an $m$-ball
$D$ fields on $D\times X$ (for $m+k < n$) or the blob complex $\bc_*(D\times X; c)$
(for $m+k = n$). \nn{need to explain $c$}.
\item An $A_\infty$ $n{-}k{+}1$-category $\bc(Y)$, defined similarly.
\item Two $\bc(Y)$ modules $\bc(X_1)$ and $\bc(X_2)$, which assign to a marked
$m$-ball $(D, H)$ either fields on $(D\times Y) \cup (H\times X_i)$ (if $m+k < n$)
or the blob complex $\bc_*((D\times Y) \cup (H\times X_i))$ (if $m+k = n$).
\end{itemize}

\begin{thm}
$\bc(X) \cong \bc(X_1) \otimes_{\bc(Y), J} \bc(X_2)$.
\end{thm}

\begin{proof}
The proof is similar to that of Theorem \ref{product_thm}.
\nn{need to say something about dimensions less than $n$, 
but for now concentrate on top dimension.}

Let $\cT$ denote the $n{-}k$-category $\bc(X_1) \otimes_{\bc(Y), J} \bc(X_2)$.
Let $D$ be an $n{-}k$-ball.
There is an obvious map from $\cT(D)$ to $\bc_*(D\times X)$.
To get a map in the other direction, we replace $\bc_*(D\times X)$ with a subcomplex
$\cS_*$ which is adapted to a fine open cover of $D\times X$.
For sufficiently small $j$ (depending on the cover), we can find, for each $j$-blob diagram $b$
on $D\times X$, a decomposition of $J$ such that $b$ splits on the corresponding
decomposition of $D\times X$.
The proof that these two maps are inverse to each other is the same as in
Theorem \ref{product_thm}.
\end{proof}


\medskip

The next theorem shows how to reconstruct a mapping space from local data.
Let $T$ be a topological space, let $M$ be an $n$-manifold, 
and recall the $A_\infty$ $n$-category $\pi^\infty_{\leq n}(T)$ 
of Example \ref{ex:chains-of-maps-to-a-space}.
Think of $\pi^\infty_{\leq n}(T)$ as encoding everything you would ever
want to know about spaces of maps of $k$-balls into $T$ ($k\le n$).
To simplify notation, let $\cT = \pi^\infty_{\leq n}(T)$.

\begin{thm} \label{thm:map-recon}
$\cB^\cT(M) \simeq C_*(\Maps(M\to T))$.
\end{thm}
\begin{proof}
We begin by constructing chain map $g: \cB^\cT(M) \to C_*(\Maps(M\to T))$.
We then use \ref{extension_lemma_b} to show that $g$ induces isomorphisms on homology.

Recall that the homotopy colimit $\cB^\cT(M)$ is constructed out of a series of
$j$-fold mapping cylinders, $j \ge 0$.
So, as an abelian group (but not as a chain complex), 
\[
	\cB^\cT(M) = \bigoplus_{j\ge 0} C^j,
\]
where $C^j$ denotes the new chains introduced by the $j$-fold mapping cylinders.

Recall that $C^0$ is a direct sum of chain complexes with the summands indexed by
decompositions of $M$ which have their $n{-}1$-skeletons labeled by $n{-}1$-morphisms
of $\cT$.
Since $\cT = \pi^\infty_{\leq n}(T)$, this means that the summands are indexed by pairs
$(K, \vphi)$, where $K$ is a decomposition of $M$ and $\vphi$ is a continuous
maps from the $n{-}1$-skeleton of $K$ to $T$.
The summand indexed by $(K, \vphi)$ is
\[
	\bigotimes_b D_*(b, \vphi),
\]
where $b$ runs through the $n$-cells of $K$ and $D_*(b, \vphi)$ denotes
chains of maps from $b$ to $T$ compatible with $\vphi$.
We can take the product of these chains of maps to get a chains of maps from
all of $M$ to $K$.
This defines $g$ on $C^0$.

We define $g(C^j) = 0$ for $j > 0$.
It is not hard to see that this defines a chain map from 
$\cB^\cT(M)$ to $C_*(\Maps(M\to T))$.

Next we show that $g$ induces a surjection on homology.
Fix $k > 0$ and choose an open cover $\cU$ of $M$ fine enough so that the union 
of any $k$ open sets of $\cU$ is contained in a disjoint union of balls in $M$.
\nn{maybe should refer to elsewhere in this paper where we made a very similar argument}
Let $S_*$ be the subcomplex of $C_*(\Maps(M\to T))$ generated by chains adapted to $\cU$.
It follows from Lemma \ref{extension_lemma_b} that $C_*(\Maps(M\to T))$
retracts onto $S_*$.

Let $S_{\le k}$ denote the chains of $S_*$ of degree less than or equal to $k$.
We claim that $S_{\le k}$ lies in the image of $g$.
Let $c$ be a generator of $S_{\le k}$ --- that is, a $j$-parameter family of maps $M\to T$,
$j \le k$.
We chose $\cU$ fine enough so that the support of $c$ is contained in a disjoint union of balls
in $M$.
It follow that we can choose a decomposition $K$ of $M$ so that the support of $c$ is 
disjoint from the $n{-}1$-skeleton of $K$.
It is now easy to see that $c$ is in the image of $g$.

Next we show that $g$ is injective on homology.




\nn{...}



\end{proof}

\nn{maybe should also mention version where we enrich over
spaces rather than chain complexes; should comment on Lurie's (and others') similar result
for the $E_\infty$ case, and mention that our version does not require 
any connectivity assumptions}

\medskip
\hrule
\medskip

\nn{to be continued...}
\medskip
\nn{still to do: fiber bundles, general maps}

\todo{}
Various citations we might want to make:
\begin{itemize}
\item \cite{MR2061854} McClure and Smith's review article
\item \cite{MR0420610} May, (inter alia, definition of $E_\infty$ operad)
\item \cite{MR0236922,MR0420609} Boardman and Vogt
\item \cite{MR1256989} definition of framed little-discs operad
\end{itemize}

We now turn to establishing the gluing formula for blob homology, restated from Property \ref{property:gluing} in the Introduction
\begin{itemize}
%\mbox{}% <-- gets the indenting right
\item For any $(n-1)$-manifold $Y$, the blob homology of $Y \times I$ is
naturally an $A_\infty$ category. % We'll write $\bc_*(Y)$ for $\bc_*(Y \times I)$ below.

\item For any $n$-manifold $X$, with $Y$ a codimension $0$-submanifold of its boundary, the blob homology of $X$ is naturally an
$A_\infty$ module for $\bc_*(Y \times I)$.

\item For any $n$-manifold $X$, with $Y \cup Y^{\text{op}}$ a codimension
$0$-submanifold of its boundary, the blob homology of $X'$, obtained from
$X$ by gluing along $Y$, is the $A_\infty$ self-tensor product of
$\bc_*(X)$ as an $\bc_*(Y \times I)$-bimodule.
\begin{equation*}
\bc_*(X') \iso \bc_*(X) \Tensor^{A_\infty}_{\mathclap{\bc_*(Y \times I)}} \!\!\!\!\!\!\xymatrix{ \ar@(ru,rd)@<-1ex>[]}
\end{equation*}
\end{itemize}

